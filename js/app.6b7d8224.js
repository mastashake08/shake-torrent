(function(e){function t(t){for(var o,s,i=t[0],c=t[1],l=t[2],u=0,p=[];u<i.length;u++)s=i[u],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&p.push(r[s][0]),r[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);d&&d(t);while(p.length)p.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,i=1;i<n.length;i++){var c=n[i];0!==r[c]&&(o=!1)}o&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var o={},r={app:0},a=[];function s(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=o,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(n,o,function(t){return e[t]}.bind(null,o));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/shake-torrent/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var d=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0401":function(e,t,n){},1:function(e,t){},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},15:function(e,t){},16:function(e,t){},17:function(e,t){},18:function(e,t){},19:function(e,t){},2:function(e,t){},20:function(e,t){},21:function(e,t){},22:function(e,t){},23:function(e,t){},24:function(e,t){},25:function(e,t){},26:function(e,t){},27:function(e,t){},28:function(e,t){},"298c":function(e,t,n){"use strict";n("3e8a")},"2d3e":function(e,t,n){"use strict";n("0401")},3:function(e,t){},"3e8a":function(e,t,n){},4:function(e,t){},5:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);var o=n("2b0e"),r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("img",{attrs:{alt:"Shake Torrent logo",src:n("f5a3"),width:"500",height:"200"}}),t("MainView",{attrs:{msg:"Shake Torrent - WebTorrent File Viewer"}})],1)},a=[],s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"hello"},[t("h1",[e._v(e._s(e.msg))]),t("div",{staticClass:"seeder"},[e.seededTorrent.magnetURI?t("t-button",{on:{click:e.share}},[e._v("Share seeded file")]):e._e(),t("t-input",{staticClass:"btn",attrs:{type:"file",multiple:""},on:{change:e.seed}},[e._v(" Seed File")]),e.seededTorrent.magnetURI?t("div",{staticClass:"files"},[t("div",{staticClass:"accordion"},[e._v(e._s(e.seededTorrent.name)+" "),t("br"),t("label",[t("b",[e._v("Num. of peers "+e._s(e.seededTorrent.numPeers)+" ")])]),t("br"),t("div",{staticClass:"button-actions"},[t("button",{on:{click:e.toggle}},[e._v("Toggle File List")])])]),t("div",{staticClass:"panel"},[t("ol",e._l(e.seededTorrent.files,(function(n,o){return t("li",{key:o,attrs:{id:n.name},on:{click:function(t){return e.preview(n)}}},[t("a",{attrs:{href:"#"}},[e._v(e._s(n.name))])])})),0)])]):e._e()],1),t("hr"),t("div",{staticClass:"downloader"},[e._l(e.torrents,(function(n,o){return t("div",{key:o,staticClass:"torrent-progress"},[t("div",{staticClass:"files"},[t("div",{staticClass:"accordion"},[e._v(e._s(n.name)+" "),t("br"),t("label",[t("b",[e._v("Num. of peers "+e._s(n.numPeers)+" ")])]),t("br"),t("progress",{attrs:{id:n.name,max:"100"},domProps:{value:100*n.progress}}),e._v(" "+e._s(Math.round(100*n.progress))+"% "),t("br"),n.progress<1?t("span",[e._v("Time Remaining: "+e._s(e.millisToMinutesAndSeconds(n.timeRemaining)))]):e._e(),t("div",{staticClass:"button-actions"},[t("button",{on:{click:e.toggle}},[e._v("Toggle File List")]),t("br"),t("button",{on:{click:function(t){return e.destroyTorrent(o)}}},[e._v("Destroy Torrent")]),t("br"),1===n.progress?t("button",{on:{click:function(t){return e.downloadZip(n)}}},[e._v("Download Files")]):e._e()])]),t("div",{staticClass:"panel",attrs:{id:n.infoHash}},[t("ol",e._l(n.files,(function(o,r){return t("li",{key:r,attrs:{id:o.length},on:{click:function(t){return e.preview(o,n)}}},[t("a",{attrs:{href:"#"}},[e._v(e._s(o.name))])])})),0)])]),t("br")])})),t("t-input",{attrs:{type:"text"},model:{value:e.magnet,callback:function(t){e.magnet=t},expression:"magnet"}}),t("t-button",{attrs:{classes:"['block', 'px-4', 'py-2', 'transition', 'duration-100']"},on:{click:e.download}},[e._v("Download File")])],2)])},i=[],c=(n("14d9"),n("ad2b")),l=n.n(c),d=n("21a6"),u=n("c4e3"),p=n.n(u),f={name:"MainView",props:{msg:String},data(){return{client:{},seededTorrent:{},magnet:"",downloadProgress:0,downloading:!1,numPeers:0,torrentFiles:[],downloaded:!1,torrents:[]}},created(){this.client=new l.a},mounted(){this.getParams()},methods:{destroyTorrent(e){this.torrents[e].destroy(),this.torrents.splice(e,1)},preview(e,t){const n=document.getElementById(t.infoHash),o=document.getElementById(e.length);0==o.classList.contains("disabled")&&(e.appendTo(n),o.classList.add("disabled"))},millisToMinutesAndSeconds(e){var t=Math.floor(e/6e4),n=(e%6e4/1e3).toFixed(0);return t+":"+(n<10?"0":"")+n},seed(e){try{const t=e.target.files,n=this;n.client.seed(t,(function(e){n.seededTorrent=e}))}catch(t){console.log(t.message)}},async download(){const e=this;try{const t={torrent:this.magnet},n=await fetch("http://localhost:3000/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),o=await n.json();this.magnet=o.magnetUri,this.client.add(this.magnet,{announce:["wss://tracker.openwebtorrent.com","wss://tracker.btorrent.xyz","wss://tracker.webtorrent.dev"]},t=>{e.torrents.push(t),e.downloading=!0,e.downloaded=!1,t.on("download",(function(){e.downloadProgress=100*t.progress,e.numPeers=t.numPeers})),t.on("done",(async function(){chrome.notifications.create({title:t.name+" Downloaded!",message:"Enjoy your torrent!",iconUrl:"/image/shake-48.png",type:"basic"}),t.zip=new p.a,await t.files.forEach(async e=>{await e.getBlob(async(n,o)=>{await t.zip.file(e.name,o)})}),t.files.forEach(t=>{e.torrentFiles.push(t)}),e.downloading=!1,e.downloaded=!0}))})}catch{this.client.add(this.magnet,{announce:["wss://tracker.openwebtorrent.com","wss://tracker.btorrent.xyz","wss://tracker.webtorrent.dev"]},t=>{e.torrents.push(t),e.downloading=!0,e.downloaded=!1,t.on("download",(function(){e.downloadProgress=100*t.progress,e.numPeers=t.numPeers})),t.on("done",(async function(){t.zip=new p.a,await t.files.forEach(async e=>{await e.getBlob(async(n,o)=>{await t.zip.file(e.name,o)})}),t.files.forEach(t=>{e.torrentFiles.push(t)}),e.downloading=!1,e.downloaded=!0}))})}},async downloadZip(e){try{const t=this;e.zip.generateAsync({type:"blob"}).then((function(n){Object(d["saveAs"])(n,e.name+".zip"),t.zip={}}))}catch(t){console.log(t.message)}},toggle(e){const t=e.target.parentNode.parentNode;t.classList.toggle("active");var n=t.nextElementSibling;"block"===n.style.display?n.style.display="none":n.style.display="block"},async share(){const e=this.seededTorrent.magnetURI;try{await navigator.share(e)}catch{await navigator.clipboard.writeText(e),alert("Magnet URI written to your clipboard")}},registerHandler(){const e=this.getHashParamsFromUrl();navigator.registerProtocolHandler("magnet","%s="+e,"Shake Torrent magnet handler")},getParams(){this.magnet=this.getHashParamsFromUrl()},getHashParamsFromUrl(){const e=location.hash?location.hash.replace(/^#/,""):"";return e.length>0?window.location.hash.substr(1):""}}},g=f,h=(n("298c"),n("2877")),m=Object(h["a"])(g,s,i,!1,null,"23ce789c",null),T=m.exports,b={name:"App",components:{MainView:T}},w=b,v=(n("2d3e"),Object(h["a"])(w,r,a,!1,null,null,null)),y=v.exports,_=n("2a13"),k=n.n(_),P=n("481d");const x={TInput:P["TInput"],TTextarea:P["TTextarea"],TSelect:P["TSelect"],TRadio:P["TRadio"],TCheckbox:P["TCheckbox"],TButton:P["TButton"],TInputGroup:P["TInputGroup"],TCard:P["TCard"],TAlert:P["TAlert"],TModal:P["TModal"],TDropdown:P["TDropdown"],TRichSelect:P["TRichSelect"],TPagination:P["TPagination"],TTag:P["TTag"],TRadioGroup:P["TRadioGroup"],TCheckboxGroup:P["TCheckboxGroup"],TTable:P["TTable"],TDatepicker:P["TDatepicker"],TToggle:P["TToggle"],TDialog:P["TDialog"]};o["default"].use(k.a,x),o["default"].config.productionTip=!1,new o["default"]({render:e=>e(y)}).$mount("#app")},6:function(e,t){},7:function(e,t){},8:function(e,t){},9:function(e,t){},f5a3:function(e,t,n){e.exports=n.p+"img/cover.4f4eaf6e.png"}});
//# sourceMappingURL=app.6b7d8224.js.map